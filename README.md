# Network Analyzer

Анализатор сетевого трафика для мониторинга и диагностики сетевой активности в реальном времени.

## Описание

Программа захватывает сетевые пакеты с помощью libpcap и предоставляет детальную статистику по:
- Протоколам (TCP, UDP, ICMP)
- Активным хостам и их трафику
- Используемым портам
- Скорости передачи данных
- Потерянным пакетам

## Возможности

- **Захват трафика** - анализ входящего и исходящего трафика
- **Фильтрация** - поддержка BPF фильтров (как в tcpdump)
- **Статистика в реальном времени** - обновление с настраиваемым интервалом
- **Анализ хостов** - детальная статистика по IP-адресам
- **Анализ портов** - активность по портам и соединениям
- **Мониторинг потерь** - отслеживание потерянных пакетов

## Сборка

```bash
make clean && make
```

## Использование

### Базовый анализ
```bash
./net_analyzer eth0
```

### С фильтром
```bash
./net_analyzer -f "tcp port 80" eth0
```

### С интервалом обновления
```bash
./net_analyzer -i 10 eth0
```

### Список интерфейсов
```bash
./net_analyzer -l
```

## Опции

- `-h, --help` - показать справку
- `-v, --version` - показать версию
- `-i <секунды>` - интервал обновления статистики (по умолчанию: 5)
- `-f <фильтр>` - BPF фильтр (например: 'tcp port 80')
- `-l` - список доступных интерфейсов
- `-s` - показать статистику в реальном времени

## Пример вывода

```
----------------------------------------------------------------
                        СЕТЕВАЯ СТАТИСТИКА
----------------------------------------------------------------
Время работы: 10 сек
Всего пакетов: 150
Всего байт: 45.2 KB
Скорость пакетов: 15.0 pkt/s
Скорость данных: 4.52 KB/s
----------------------------------------------------------------
TCP пакетов: 120
UDP пакетов: 25
ICMP пакетов: 5
Других пакетов: 0
Потерянных пакетов: 0
Потеряно ядром: 0
Потеряно интерфейсом: 0
Уникальных хостов: 5
Активных портов: 8

----------------------------------------------------------------
                        СТАТИСТИКА ХОСТОВ
----------------------------------------------------------------
IP: 192.168.1.1
Пакетов от этого хоста: 45
Пакетов к этому хосту: 30
Байт от этого хоста: 12.5 KB
Байт к этому хосту: 8.2 KB
-----
IP: 8.8.8.8
Пакетов от этого хоста: 15
Пакетов к этому хосту: 15
Байт от этого хоста: 2.1 KB
Байт к этому хосту: 2.1 KB
-----

----------------------------------------------------------------
                      СТАТИСТИКА ПОРТОВ
----------------------------------------------------------------
Порт: 80
Соединения: 25
Байт: 18.3 KB
Последняя активность: 14:30:15
-----
Порт: 443
Соединения: 35
Байт: 22.1 KB
Последняя активность: 14:30:18
-----
```

## Требования

- Linux
- libpcap-dev
- gcc с поддержкой C11

## Установка зависимостей

```bash
sudo apt install libpcap-dev
```

## Структура проекта

```
network_analyzer/
├── src/
│   ├── main.c              # Основная логика
│   ├── packet_analyzer.c   # Анализ пакетов
│   ├── statistics.c        # Сбор статистики
│   └── utils.c             # Утилиты
├── include/
│   ├── packet_analyzer.h   # Заголовки анализатора
│   ├── statistics.h        # Заголовки статистики
│   └── utils.h             # Заголовки утилит
├── Makefile                # Сборка
└── README.md               # Документация
```

## Особенности реализации

- Использование libpcap для захвата пакетов
- Многопоточность для сбора статистики
- Поддержка BSD-совместимых типов данных
- Обработка различных сетевых протоколов
- Форматирование вывода для удобства чтения

## Лицензия

[MIT License](LICENSE)